<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>WebParser: Using StringIndex2 - Rainmeter Tips &amp; Tricks</title>
	<link href="/css/main.css?v=1" rel="stylesheet">
	<link rel="shortcut icon" href="//www.rainmeter.net/favicon.ico">
	<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6/html5shiv.min.js"></script><![endif]-->
</head>
<body>
	<div id="wrapper">
		<div id="top">
			<div class="container">
				<a id="logo" href="//rainmeter.net/"></a>
				<nav id="nav">
					<ul>
					<li><a href="//www.rainmeter.net">Home</a>
					<li><a href="//www.rainmeter.net/about">About</a>
					<li><a href="/" class="active">Docs</a>
					<li><a href="//www.rainmeter.net/discover">Discover</a>
					<li><a href="//forum.rainmeter.net">Forum</a>
					</ul>
				</nav>
			</div>
		</div>

		<div class="container">
			<div class="row">
				<div id="side-content">
	<h1 id="category"><a href="/tips">Tips &amp; Tricks</a></h1>

	<form id="search-form" method="get" action="http://www.google.com/search">
		<input name="sitesearch" value="docs.rainmeter.net" type="hidden">
		<input id="search" name="q" maxlength="255" size="16" placeholder="Search" type="text">
	</form>

	<nav id="tree">
		<h1>Contents</h1>
<ul>
<li><a href="/tips/#BeyondTheBasics">Beyond the Basics</a>
<li><a href="/tips/#GoodToKnow">Good To Know</a>
<li><a href="/tips/#GettingThingsDone">Getting Things Done</a>
</ul>

<h1>More</h1>
<ul>
<li><a href="/manual/">3.3 Final Manual</a>
<li><a href="/manual-beta/">4.0 Beta Manual</a>
<li><a href="/snippets/">Snippets</a>
<li><a href="/developers/">Developers</a>
<li><a href="/history/">Version History</a>
</ul>

	</nav>
</div>
<div id="content">
	<header>
		<h1>WebParser: Using StringIndex2</h1>
	</header>
	<article><p>One of less obvious features of the WebParser Plugin is the capability that the option <code>StringIndex2=</code> brings to simplify skins retrieving repetitive data like an RSS or weather feed.</p>

<p>From the <a href="/manual/plugins/webparser/#StringIndex2">Manual</a>:</p>

<p><b>StringIndex2</b><br>
The second string index is used when using a <code>RegExp</code> in a measure that uses data from another WebParser measure (i.e. the <code>URL</code> points to a parent measure. In this case the <code>StringIndex</code> defines the index of the result of the parent measure's <code>RegExp</code> and the <code>StringIndex2</code> defines the index of this measure's <code>RegExp</code> (i.e. it defines the string that the measure returns).</p>

<p>First, here is the entire code of a little skin to demonstrate how to use this feature. Go ahead and create this and run it to see it in action:</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">[Rainmeter]&#10;Update=1000&#10;DynamicWindowSize=1&#10;&#10;[Variables]&#10;Item=.*&#60;item&#62;(.*)&#60;/item&#62;&#10;Sub=&#34;&#60;![CDATA[&#34;:&#34;&#34;,&#34;]]&#62;&#34;:&#34;&#34;&#10;&#10;[MeasureSite]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=http://feeds.gawker.com/lifehacker/full&#10;RegExp=&#34;(?siU)&#60;title&#62;(.*)&#60;/title&#62;.*&#60;link&#62;(.*)&#60;/link&#62;#Item##Item##Item#&#34;&#10;&#10;[MeasureMainTitle]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=[MeasureSite]&#10;StringIndex=1&#10;Substitute=#Sub#&#10;&#10;[MeasureMainLink]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=[MeasureSite]&#10;StringIndex=2&#10;&#10;[MeasureItem1Title]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=[MeasureSite]&#10;RegExp=&#34;(?siU)&#60;title&#62;(.*)&#60;/title&#62;&#34;&#10;StringIndex=3&#10;StringIndex2=1&#10;Substitute=#Sub#&#10;&#10;[MeasureItem1Link]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=[MeasureSite]&#10;RegExp=&#34;(?siU)&#60;link&#62;(.*)&#60;/link&#62;&#34;&#10;StringIndex=3&#10;StringIndex2=1&#10;&#10;[MeasureItem2Title]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=[MeasureSite]&#10;RegExp=&#34;(?siU)&#60;title&#62;(.*)&#60;/title&#62;&#34;&#10;StringIndex=4&#10;StringIndex2=1&#10;Substitute=#Sub#&#10;&#10;[MeasureItem2Link]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=[MeasureSite]&#10;RegExp=&#34;(?siU)&#60;link&#62;(.*)&#60;/link&#62;&#34;&#10;StringIndex=4&#10;StringIndex2=1&#10;&#10;[MeasureItem3Title]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=[MeasureSite]&#10;RegExp=&#34;(?siU)&#60;title&#62;(.*)&#60;/title&#62;&#34;&#10;StringIndex=5&#10;StringIndex2=1&#10;Substitute=#Sub#&#10;&#10;[MeasureItem3Link]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=[MeasureSite]&#10;RegExp=&#34;(?siU)&#60;link&#62;(.*)&#60;/link&#62;&#34;&#10;StringIndex=5&#10;StringIndex2=1&#10;&#10;[MeterMainTitle]&#10;Meter=String&#10;MeasureName=MeasureMainTitle&#10;X=0&#10;Y=0&#10;FontSize=13&#10;FontColor=255,255,255,255&#10;SolidColor=0,0,0,1&#10;StringStyle=Bold&#10;Antialias=1&#10;LeftMouseUpAction=[&#34;[MeasureMainLink]&#34;]&#10;&#10;[MeterItem1Title]&#10;Meter=String&#10;MeasureName=MeasureItem1Title&#10;X=0&#10;Y=5R&#10;W=300&#10;H=35&#10;ClipString=1&#10;FontSize=11&#10;FontColor=255,255,255,255&#10;SolidColor=0,0,0,1&#10;Antialias=1&#10;LeftMouseUpAction=[&#34;[MeasureItem1Link]&#34;]&#10;&#10;[MeterItem2Title]&#10;Meter=String&#10;MeasureName=MeasureItem2Title&#10;X=0&#10;Y=5R&#10;W=300&#10;H=35&#10;ClipString=1&#10;FontSize=11&#10;FontColor=255,255,255,255&#10;SolidColor=0,0,0,1&#10;Antialias=1&#10;LeftMouseUpAction=[&#34;[MeasureItem2Link]&#34;]&#10;&#10;[MeterItem3Title]&#10;Meter=String&#10;MeasureName=MeasureItem3Title&#10;X=0&#10;Y=5R&#10;W=300&#10;H=35&#10;ClipString=1&#10;FontSize=11&#10;FontColor=255,255,255,255&#10;SolidColor=0,0,0,1&#10;Antialias=1&#10;LeftMouseUpAction=[&#34;[MeasureItem3Link]&#34;]</span><br></pre></td></tr></table></figure>

<div class="exampleprev">
<img src="/tips/img/webparser-using-stringindex2/UsingStringIndex2.jpg"/>
</div>

<p>So let's tear this apart and see what it is doing:</p>

<p>First, we set a variable that simply gets everything in between &lt;item&gt; and &lt;/item&gt; from the site.</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">[Variables]&#10;Item=.*&#60;item&#62;(.*)&#60;/item&#62;</span><br></pre></td></tr></table></figure>

<p>Then we use WebParser to go get the information from the site.</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">[MeasureSite]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=http://feeds.gawker.com/lifehacker/full&#10;RegExp=&#34;(?siU)&#60;title&#62;(.*)&#60;/title&#62;.*&#60;link&#62;(.*)&#60;/link&#62;#Item##Item##Item#&#34;</span><br></pre></td></tr></table></figure>

<p>Notice we are doing something a bit different here. Instead of fully parsing the site into many, many StringIndexes on the main measure, we are just getting the main title and link for the site into StringIndexes 1 and 2, then getting the <em>entire</em> contents of each &lt;item&gt; into StringIndexes 3, 4 and 5.</p>

<p>Now let's skip the measures for the main title and link, they are done the normal way. Let's move down to this measure:</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">[MeasureItem1Title]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=[MeasureSite]&#10;RegExp=&#34;(?siU)&#60;title&#62;(.*)&#60;/title&#62;&#34;&#10;StringIndex=3&#10;StringIndex2=1&#10;Substitute=#Sub#</span><br></pre></td></tr></table></figure>

<p>What we are doing is using the StringIndex2= feature to get the &lt;title&gt; of the first &lt;item&gt; from the feed. We define <code>StringIndex=3</code>, which will return the entire first &lt;item&gt; from the main WebParser measure at the top. Then, unlike a normal "child" measure in WebParser, we use a RegExp= to parse the information in that <code>StringIndex=3</code> and return the single bit of information we want from that &lt;item&gt; in a <code>StringIndex2=1</code> on this measure.</p>

<p>Remember, the way StringIndex2 works is that IF a WebParser measure is using an earlier WebParser measure as the Url= AND the measure has a RegExp= on it, then the RegExp= is applied to the data in StringIndex, and the result is returned in StringIndex2.</p>

<p><em>The "value" of the measure, when used for instance in a MeasureName= option in a meter, is what is returned in StringIndex2.</em></p>

<p>We can repeat this process to get the link of the first item:</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">[MeasureItem1Link]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=[MeasureSite]&#10;RegExp=&#34;(?siU)&#60;link&#62;(.*)&#60;/link&#62;&#34;&#10;StringIndex=3&#10;StringIndex2=1</span><br></pre></td></tr></table></figure>

<p>Note that once again we are getting the entire &lt;item&gt; data from <code>StringIndex=3</code> of the main measure, then using a RegExp= to get just the link from that information into <code>StringIndex2=1</code> on this measure.</p>

<p>It might be obvious by now, but when we want to carry on with the second &lt;item&gt; from the feed, we use:</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">[MeasureItem2Title]&#10;Measure=Plugin&#10;Plugin=WebParser&#10;Url=[MeasureSite]&#10;RegExp=&#34;(?siU)&#60;title&#62;(.*)&#60;/title&#62;&#34;&#10;StringIndex=4&#10;StringIndex2=1&#10;Substitute=#Sub#</span><br></pre></td></tr></table></figure>

<p>So now we are getting the information for the entire second &lt;item&gt; from the main measure, which is in <code>StringIndex=4</code> on that measure. Then we parse it with a RegExp= and the result is returned in the <code>StringIndex2=1</code> on this measure.</p>

<p>Play with this a bit, and you might find that it can save a lot of extra parsing and creating huge RegExp= options to parse absolutely everything out of a site all at once up front. Get the main site in big chunks, then deal with the chunks as if they were sites in and of themselves.</p>

<p><em>Hint: This can be a nice way to get around the limit of 99 StringIndex numbers on any single WebParser measure...</em></p>
</article>
</div>

			</div>
		</div>

		<div id="footer-push"></div>
	</div>

	<script src="/js/main.js?v=2"></script>
</body>
</html>
