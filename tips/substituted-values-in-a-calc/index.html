<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Substituted Values in a Calc - Rainmeter Tips &amp; Tricks</title>
	<link href="/css/main.css?v=3" rel="stylesheet">
	<link rel="shortcut icon" href="//www.rainmeter.net/favicon.ico">
	<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6/html5shiv.min.js"></script><![endif]-->
</head>
<body>
	<div id="wrapper">
		<div id="top">
			<div class="container">
				<a id="logo" href="//rainmeter.net/"></a>
				<nav id="nav">
					<ul>
					<li><a href="//www.rainmeter.net">Home</a>
					<li><a href="/" class="active">Documentation</a>
					<li><a href="//www.rainmeter.net/discover">Discover</a>
					<li><a href="//forum.rainmeter.net">Community</a>
					</ul>
				</nav>
			</div>
		</div>

		<div class="container">
			<div class="row">
				<div id="side-content">
	<h1 id="category"><a href="/tips">Tips &amp; Tricks</a></h1>

	<form id="search-form" method="get" action="http://www.google.com/search">
		<input name="sitesearch" value="docs.rainmeter.net" type="hidden">
		<input id="search" name="q" maxlength="255" size="16" placeholder="Search" type="text">
	</form>

	<nav id="tree">
		<h1>Contents</h1>
<ul>
<li><a href="/tips/#BeyondTheBasics">Beyond the Basics</a>
<li><a href="/tips/#GoodToKnow">Good To Know</a>
<li><a href="/tips/#GettingThingsDone">Getting Things Done</a>
</ul>

<h1>More</h1>
<ul>
<li><a href="/manual/">4.0 Final Manual</a>
<li><a href="/manual-beta/">4.1 Beta Manual</a>
<li><a href="/snippets/">Snippets</a>
<li><a href="/developers/">Developers</a>
<li><a href="/history/">Version History</a>
</ul>

	</nav>
</div>
<div id="content">
	<header>
		<h1>Substituted Values in a Calc</h1>
	</header>
	<article><p>Calc measures are a useful tool that let you perform any number of operations on the values you get from measures. However, sometimes you need to get the substituted value from that measure. The Calc measure has two ways to get the values of the measure. The first way is to use that measure's name directly. This use the number value of the measure in your Calc formula. The second way is to use section variables. Here, the other measure's name is encased in square brackets and the line <code>DynamicVariables=1</code> is added to the Calc measure. The this will use the string value of the measure, and if the measure has a substitution string, it will perform the substitutions before using it. Here is a quick example demonstrating this effect:</p>

<figure class="highlight ini"><table><tr><td class="code"><pre><div class="line"><span class="section">[InitialValue]</span></div><div class="line"><span class="attr">Measure</span>=Calc</div><div class="line"><span class="attr">Formula</span>=<span class="number">12345</span></div><div class="line"><span class="attr">Substitute</span>=<span class="string">"2"</span>:<span class="string">"22"</span>,<span class="string">"4"</span>:<span class="string">"7"</span></div><div class="line"></div><div class="line"><span class="section">[GetDirectValue]</span></div><div class="line"><span class="attr">Measure</span>=Calc</div><div class="line"><span class="attr">Formula</span>=InitialValue</div><div class="line"></div><div class="line"><span class="section">[GetSubstitutedValue]</span></div><div class="line"><span class="attr">Measure</span>=Calc</div><div class="line"><span class="attr">Formula</span>=[InitialValue]</div><div class="line"><span class="attr">DynamicVariables</span>=<span class="number">1</span></div></pre></td></tr></table></figure>

<p>In this case, the value of [GetDirectValue] would be "12345", whereas the value of [GetSubstitutedValue] would have the "2" replaced with "22" and the "4" replaced with "7". As a result, its value would instead be "122375". </p>

<p>There are many uses for this, particularly when reading the direct value of the measure is impossible. Let's say you have a log file somewhere that returns whether or not some system is running. You already know that the only possible values are "Running" and "Offline" and you want to show a green light for "Running" and and red light for "Offline". The simplest method to check for a specific value is to use the "IfEqualValue" and "IfEqualAction". Unfortunately, this will not work because they require a number to compare and your results are strings. Instead, we can add a substitute string that will convert these strings into numbers, then use a Calc measure to do the comparison. Here is some example code showing how to do this:</p>

<figure class="highlight ini"><table><tr><td class="code"><pre><div class="line"><span class="section">[MeasureGetStatus]</span></div><div class="line"><span class="attr">Measure</span>=Plugin</div><div class="line"><span class="attr">Plugin</span>=WebParser</div><div class="line"><span class="attr">URL</span>=http://www.somesite.com/logs/status.xml</div><div class="line"><span class="attr">RegExp</span>=<span class="string">"(?siU)&lt;status&gt;(.*)&lt;/status&gt;"</span></div><div class="line"><span class="attr">StringIndex</span>=<span class="number">1</span></div><div class="line"><span class="attr">Substitute</span>=<span class="string">"Running"</span>:<span class="string">"1"</span>,<span class="string">"Offline"</span>:<span class="string">"0"</span></div><div class="line"></div><div class="line"><span class="section">[MeasureCheckStatus]</span></div><div class="line"><span class="attr">Measure</span>=Calc</div><div class="line"><span class="attr">Formula</span>=[MeasureGetStatus]</div><div class="line"><span class="attr">IfEqualValue</span>=<span class="number">1</span></div><div class="line"><span class="attr">IfEqualAction</span>=[!ShowMeter MeterGreenLight][!HideMeter MeterRedLight]</div><div class="line"><span class="attr">IfBelowValue</span>=<span class="number">1</span></div><div class="line"><span class="attr">IfBelowAction</span>=[!ShowMeter MeterRedLight][!HideMeter MeterGreenLight]</div><div class="line"><span class="attr">DynamicVariables</span>=<span class="number">1</span></div><div class="line"></div><div class="line"><span class="section">[MeterGreenLight]</span></div><div class="line"><span class="attr">Meter</span>=Image</div><div class="line"><span class="attr">ImageName</span>=GreenLight.png</div><div class="line"><span class="attr">Hidden</span>=<span class="number">1</span></div><div class="line"></div><div class="line"><span class="section">[MeterRedLight]</span></div><div class="line"><span class="attr">Meter</span>=Image</div><div class="line"><span class="attr">ImageName</span>=RedLight.png</div><div class="line"><span class="attr">Hidden</span>=<span class="number">1</span></div></pre></td></tr></table></figure>

<p>The Calc measure would receive the value as either "1" or "0" instead of the strings "Running" and "Offline", which lets it perform the comparisons to activate the proper lights.</p>
</article>
</div>

			</div>
		</div>

		<div id="footer-push"></div>
	</div>

	<script src="/js/main.js?v=4"></script>
</body>
</html>
