<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Developers - Rainmeter Developers</title>
	<link href="/css/main.css?v=3" rel="stylesheet">
	<link rel="shortcut icon" href="//www.rainmeter.net/favicon.ico">
	<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6/html5shiv.min.js"></script><![endif]-->
</head>
<body>
	<div id="wrapper">
		<div id="top">
			<div class="container">
				<a id="logo" href="//rainmeter.net/"></a>
				<nav id="nav">
					<ul>
					<li><a href="//www.rainmeter.net">Home</a>
					<li><a href="/" class="active">Documentation</a>
					<li><a href="//www.rainmeter.net/discover">Discover</a>
					<li><a href="//forum.rainmeter.net">Community</a>
					</ul>
				</nav>
			</div>
		</div>

		<div class="container">
			<div class="row">
				<div id="side-content">
	<h1 id="category"><a href="/developers">Developers</a></h1>

	<form id="search-form" method="get" action="http://www.google.com/search">
		<input name="sitesearch" value="docs.rainmeter.net" type="hidden">
		<input id="search" name="q" maxlength="255" size="16" placeholder="Search" type="text">
	</form>

	<nav id="tree">
		<h1>Contents</h1>
<ul>
<li><a href="/developers/plugin/plugin-anatomy/">Anatomy of a Plugin</a>
<li><a href="/developers/plugin/cpp/">C++ Overview</a>
  <ul>
  <li><a href="/developers/plugin/cpp/api/">C++ API Reference</a>
  </ul>
<li><a href="/developers/plugin/csharp/">C# Overview</a>
  <ul>
  <li><a href="/developers/plugin/csharp/api/">C# API Reference</a>
  </ul>
<li><a href="/developers/plugin/guidelines/">Plugin Guidelines</a>
</ul>

<h1>More</h1>
<ul>
<li><a href="/manual/">4.0 Final Manual</a>
<li><a href="/manual-beta/">4.1 Beta Manual</a>
<li><a href="/tips/">Tips &amp; Tricks</a>
<li><a href="/snippets/">Snippets</a>
<li><a href="/history/">Version History</a>
</ul>

	</nav>
</div>
<div id="content">
	<header>
		<h1>Developers</h1>
	</header>
	<article><p>This page is intended for people who want to work with the source code for Rainmeter.  This can be to make or suggest changes to the project C++ source code, or to create plugins for Rainmeter in C++ or C#. In addition, there is information on interacting with Rainmeter from external applications.</p>

<p><em>Note: Documentation for creating or modifying skins in Rainmeter can be found at <a href="/">Rainmeter Documentation</a>.</em></p>

<p>The Rainmeter project is primarily written in <b>C++</b> using <b>Microsoft Visual Studio 2017</b>. In addition, custom plugins can be written and distributed separately from the official Rainmeter project using C++ or C#. This page assumes familiarity with Visual Studio and either C++ or C#.</p>

<h2 id="ProjectSourceCode">Project Source Code</h2>

<p>The source code for the Rainmeter project is maintained at <a href="https://github.com/rainmeter/rainmeter">Rainmeter Repository on GitHub</a>.</p>

<p>If you simply wish to obtain the source code to examine it or make a local change to how something works for your own use, you can simply download a .zip file from <a href="https://github.com/rainmeter/rainmeter/archive/master.zip">Download ZIP</a>.</p>

<p>The only software you will need is <b>Microsoft Visual Studio 2017</b> or the free <b>Microsoft Visual Community</b> which can be obtained at <a href="http://www.visualstudio.com/downloads/download-visual-studio-vs">Download Visual Studio</a>. Be sure to download and apply any Visual Studio Updates when prompted.</p>

<p>Create a folder containing the project code from the .zip file, and open <b>Rainmeter.sln</b> in Visual Studio. You can then set the desired <em>Solution Configuration</em> and <em>Solution Platforms</em> fields and build the solution to create Debug or Release versions in x32 or x64 architectures.</p>

<h2 id="ProjectRepository">Creating a Project Repository</h2>

<p>To do any serious work on the project source code, or to get involved in the development of Rainmeter, you will want to create a local repository and install a couple of tools to help manage your copy of the project.</p>

<p>First, you will want to install a local copy of the <a href="http://git-scm.com">Git version control</a> software on your PC. This can be obtained from <a href="http://git-scm.com/downloads">Download Git</a>.</p>

<p>Then, unless you are a fan of the Windows cmd.exe command line, it can be useful to install a Windows front-end client to help manage your Git repositories. There are several options for that, two of the more popular are <a href="https://code.google.com/p/tortoisegit/wiki/Download">TortoiseGit for Windows</a> and <a href="http://windows.github.com/">GitHub for Windows</a>.

<p>To create your repository of the project code, first create an account on <a href="https://github.com">GitHub.com</a>. Then from the <a href="https://github.com/rainmeter/rainmeter">Rainmeter Repository on GitHub</a> you can fork the project to your account. Now you can use either the Git command line or the Windows front-end client you installed to <a href="http://git-scm.com/book/en/Git-Basics-Getting-a-Git-Repository">clone the repository</a> from your personal fork of the project on GitHub to a folder on your PC.</p>

<h2 id="SubmitChanges">Submitting Code Changes</h2>

<p>If you make changes to the project source code that you would like to suggest as changes to the official build, you can make the changes in your personal GitHub repository, then at the <a href="https://github.com/rainmeter/rainmeter">Rainmeter repository</a>, create a pull request with your code changes. It will expedite things if you contact the Rainmeter Team either on the forums at <a href="//forum.rainmeter.net/viewforum.php?f=14">Bugs and Feature Suggestions</a> or on IRC at <a href="http://webchat.freenode.net/?channels=rainmeter">#Rainmeter on Freenode</a> to discuss the desired changes.</p>

<h2 id="CreateBuild">Creating a Full Rainmeter Build</h2>

<p>In order to create a full build of the Rainmeter installer, you will need one additional piece of software.</p>

<p>Get and install NSIS version 3.01 or later from <a href="http://nsis.sourceforge.net/Download">NSIS Scriptable Install System</a> software on your PC.</p>

<p>Now you can simply run the <b>Build.bat</b> batch file in the Build folder of your local repository.  If there are any "not found" errors when you run the batch file, check the paths in the <code>Set</code> commands at the top of the file.</p>

<p>Use <code>Build.bat RELEASE</code> to build a non-beta installer.</p>

<p>To digitally sign the installer and the Rainmeter executables, obtain a certificate from a <a href="http://www.certum.pl/certum/main.xml">service</a> that provides them, and create a Certificate.bat file alongside Build.bat with the following contents:</p>

<figure class="highlight dos"><table><tr><td class="code"><pre><div class="line"><span class="built_in">set</span> CERTFILE=/<span class="built_in">path</span>/to/PFXcert.p12</div><div class="line"><span class="built_in">set</span> CERTKEY=certpassword</div></pre></td></tr></table></figure>

<h2 id="CreatePlugin">Creating Rainmeter Plugins</h2>

<p>Anyone can create and distribute <a href="/manual/plugins/#Custom">custom plugins</a> for Rainmeter.</p>

<p><b>Note:</b> The Rainmeter Skin Installer program, which is used by end-users to install the skins containing your plugin, will not allow the same or older version of the plugin to overwrite a newer version. The means that it is critically important that every release of your plugin must have the "File version" number incremented. If you don't do this, your plugin will not be distributed.</p>

<p>The only software you will need is <b>Microsoft Visual Studio 2017</b> or the free <b>Microsoft Visual Community</b> which can be obtained at <a href="http://www.visualstudio.com/downloads/download-visual-studio-vs">Download Visual Studio</a>. Be sure to download and apply any Visual Studio Updates when prompted.</p>

<p>Then you will want to download the <a href="https://github.com/rainmeter/rainmeter-plugin-sdk">Rainmeter Plugin SDK</a> to a folder on your PC. The SDK contains the API code needed to create plugins, as well as some starting and sample plugin code for C++ and C#:</p>

<ul>
<li><b>PluginEmpty</b><br/>
An empty plugin template you can use as a starting point for your code.</li>
<li><b>PluginSystemVersion</b><br/>
An example plugin that returns the Windows system version to a skin.</li>
<li><b>PluginParentChild</b><br/>
An example plugin demonstrating how to do "parent-child" functions in your plugin.</li>
<li><b>PluginSectionVariables</b><br/>
An example plugin demonstrating how to implement functions to use as seciton variables in your plugin.</li>
</ul>

<p>To create a plugin, the simplest approach is to make a copy of and rename the PluginEmpty example folder and files.  Use GuidGen.exe from Visual Studio with <em>Format 4</em> to generate a new GUID  and add this and other appropriate changes to the .vcxproj or .csproj files. Open either <b>SDK-CPP.sln</b> (C++) or <b>SDK-CS.sln</b> (C#) in Visual Studio, add your new plugin project to the solution, develop your code in this template and build your plugin.  Be sure that you use the <em>Solution Configuration</em> and <em>Solution Platforms</em> fields and build both x32 and x64 architecture release versions of your plugin .dll before you distribute it.</p>

<h2 id="APIDocumentation">Plugin API Documentation</h2>

<ul>
<li>Documentation for C++ plugins can be found <a href="/developers/plugin/cpp/">here</a> and the API <a href="/developers/plugin/cpp/api/">here</a>.</li>
<li>Documentation for C# plugins can be found <a href="/developers/plugin/csharp/">here</a> and the API <a href="/developers/plugin/csharp/api/">here</a>.</li>
</ul>

<h2 id="SendMessage">Using SendMessage with External Applications</h2>

<p>The Rainmeter window message API can be used to query or control Rainmeter from external applications. The examples are for C++ and <a href="http://www.autoitscript.com/site/autoit/">AutoIt</a>, but similar functionality is available from any programming platform that can send window messages to running applications.</p>

<h3>Query</h3>

<p>The following sample demonstrates how to retrieve a running skin's window handle based on the skin config name. Note that the returned handle should only be used to check if the skin is active or not -- do not abuse the handle.</p>

<p>C/C++ code:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="comment">// Usage: GetSkinWindow(L"illustro\\Clock");</span></div><div class="line"><span class="comment">// Return value will be NULL if config not found or a valid HWND otherwise</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="function">HWND <span class="title">GetSkinWindow</span><span class="params">(<span class="keyword">const</span> WCHAR* configName)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	HWND trayWnd = FindWindow(<span class="string">L"RainmeterTrayClass"</span>, <span class="literal">NULL</span>);</div><div class="line">	<span class="keyword">if</span> (trayWnd)</div><div class="line">	&#123;</div><div class="line">		COPYDATASTRUCT cds;</div><div class="line">		cds.dwData = <span class="number">5101</span>;</div><div class="line">		cds.cbData = (DWORD)(wcslen(configName) + <span class="number">1</span>) * <span class="keyword">sizeof</span>(WCHAR);</div><div class="line">		cds.lpData = (<span class="keyword">void</span>*)configName;</div><div class="line">		<span class="keyword">return</span> (HWND)SendMessage(trayWnd, WM_COPYDATA, <span class="number">0</span>, (LPARAM)&amp;cds);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> <span class="literal">NULL</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

<p>AutoIT code:<br/></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line">; Usage: $Return = GetSkinWindow(<span class="string">"ConfigName"</span>)</div><div class="line">; Return value will be <span class="number">0</span> <span class="keyword">if</span> config <span class="keyword">not</span> found</div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;SendMessage.au3&gt;</span></span></div><div class="line"></div><div class="line"><span class="function">Func <span class="title">GetSkinWindow</span><span class="params">($szConfigName)</span></span></div><div class="line">   Local Const $hWnd = WinGetHandle("[CLASS:RainmeterTrayClass]")</div><div class="line">   If $hWnd &lt;&gt; <span class="number">0</span> Then</div><div class="line">      Local Const $iSize = StringLen($szConfigName) + <span class="number">1</span></div><div class="line"></div><div class="line">      Local Const $pMem = DllStructCreate(<span class="string">"wchar["</span> &amp; $iSize &amp; <span class="string">"]"</span>)</div><div class="line">      DllStructSetData($pMem, <span class="number">1</span>, $szConfigName)</div><div class="line"></div><div class="line">      Local Const $pCds = DllStructCreate(<span class="string">"dword;dword;ptr"</span>)</div><div class="line">      DllStructSetData($pCds, <span class="number">1</span>, <span class="number">5101</span>)</div><div class="line">      DllStructSetData($pCds, <span class="number">2</span>, ($iSize * <span class="number">2</span>))</div><div class="line">      DllStructSetData($pCds, <span class="number">3</span>, DllStructGetPtr($pMem))</div><div class="line"></div><div class="line">      Local Const $WM_COPYDATA = <span class="number">0x004A</span></div><div class="line">      Return _SendMessage($hWnd, $WM_COPYDATA, <span class="number">0</span>, DllStructGetPtr($pCds))</div><div class="line">   EndIf</div><div class="line"></div><div class="line">   Return <span class="number">0</span></div><div class="line">EndFunc</div></pre></td></tr></table></figure>

<p>The following code demonstrates how to retrieve important application path information for Rainmeter from your external application.</p>

<p>AutoIT code:<br/></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;SendMessage.au3&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GUIConstantsEx.au3&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WindowsConstants.au3&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Array.au3&gt;</span></span></div><div class="line"></div><div class="line">$RAINMETER_QUERY_WINDOW = WinGetHandle(<span class="string">"[CLASS:RainmeterTrayClass]"</span>)</div><div class="line">$WM_QUERY_RAINMETER = $WM_APP + <span class="number">1000</span></div><div class="line">$RAINMETER_QUERY_ID_SKINS_PATH = <span class="number">4101</span></div><div class="line">$RAINMETER_QUERY_ID_SETTINGS_PATH = <span class="number">4102</span></div><div class="line">$RAINMETER_QUERY_ID_PROGRAM_PATH = <span class="number">4104</span></div><div class="line">$RAINMETER_QUERY_ID_CONFIG_EDITOR = <span class="number">4106</span></div><div class="line">$WM_QUERY_RAINMETER_RETURN = <span class="string">""</span></div><div class="line"></div><div class="line">Dim $PathsArray[<span class="number">4</span>]</div><div class="line"></div><div class="line">$hGUI = GUICreate(<span class="string">""</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>)</div><div class="line"></div><div class="line">If Not ProcessExists(<span class="string">"Rainmeter.exe"</span>) Then</div><div class="line">	MsgBox(<span class="number">16</span>, <span class="string">"GetPath Error"</span>, <span class="string">"Rainmeter must be running to use GetPath."</span>)</div><div class="line">	Exit</div><div class="line">EndIf</div><div class="line"></div><div class="line">GUIRegisterMsg($WM_COPYDATA, <span class="string">"_ReadMessage"</span>)</div><div class="line"></div><div class="line"> _SendMessage($RAINMETER_QUERY_WINDOW, $WM_QUERY_RAINMETER, $RAINMETER_QUERY_ID_PROGRAM_PATH, $hGUI)</div><div class="line"> $PathsArray[<span class="number">0</span>] = $WM_QUERY_RAINMETER_RETURN</div><div class="line"></div><div class="line"> _SendMessage($RAINMETER_QUERY_WINDOW, $WM_QUERY_RAINMETER, $RAINMETER_QUERY_ID_SETTINGS_PATH, $hGUI)</div><div class="line">$PathsArray[<span class="number">1</span>] = $WM_QUERY_RAINMETER_RETURN</div><div class="line"></div><div class="line"> _SendMessage($RAINMETER_QUERY_WINDOW, $WM_QUERY_RAINMETER, $RAINMETER_QUERY_ID_SKINS_PATH, $hGUI)</div><div class="line"> $PathsArray[<span class="number">2</span>] = $WM_QUERY_RAINMETER_RETURN</div><div class="line"></div><div class="line"> _SendMessage($RAINMETER_QUERY_WINDOW, $WM_QUERY_RAINMETER, $RAINMETER_QUERY_ID_CONFIG_EDITOR, $hGUI)</div><div class="line"> $PathsArray[<span class="number">3</span>] = $WM_QUERY_RAINMETER_RETURN</div><div class="line"></div><div class="line">_ArrayDisplay($PathsArray)</div><div class="line"></div><div class="line"></div><div class="line">Func _ReadMessage($hWnd, $uiMsg, $wParam, $lParam)</div><div class="line"></div><div class="line">	$pCds = DllStructCreate(<span class="string">"dword;dword;ptr"</span>, $lParam)</div><div class="line">	$pData = DllStructGetData($pCds, <span class="number">3</span>)</div><div class="line">	$pMem = DllStructCreate(<span class="string">"wchar["</span> &amp; DllStructGetData($pCds, <span class="number">2</span>) &amp; <span class="string">"]"</span>, DllStructGetData($pCds, <span class="number">3</span>))</div><div class="line">	$WM_QUERY_RAINMETER_RETURN = DllStructGetData($pMem, <span class="number">1</span>)</div><div class="line"></div><div class="line">EndFunc ;_ReadMessage</div></pre></td></tr></table></figure>

<h3>Bangs</h3>

<p>The following samples demonstrate how external applications can send bangs to Rainmeter.</p>

<p>C/C++ code:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="comment">// Usage: SendBang(L"[!About]");</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">SendBang</span><span class="params">(<span class="keyword">const</span> WCHAR* bang)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	HWND rmWnd = FindWindow(<span class="string">L"DummyRainWClass"</span>, <span class="literal">NULL</span>);</div><div class="line">	<span class="keyword">if</span> (rmWnd)</div><div class="line">	&#123;</div><div class="line">		COPYDATASTRUCT cds;</div><div class="line">		cds.dwData = <span class="number">1</span>;</div><div class="line">		cds.cbData = (DWORD)(wcslen(bang) + <span class="number">1</span>) * <span class="keyword">sizeof</span>(WCHAR);</div><div class="line">		cds.lpData = (<span class="keyword">void</span>*)bang;</div><div class="line"></div><div class="line">		<span class="comment">// Send bang to the Rainmeter window</span></div><div class="line">		SendMessage(rmWnd, WM_COPYDATA, <span class="number">0</span>, (LPARAM)&amp;cds);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

<p>AutoIT code:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line">; Usage: SendBang(<span class="string">"[!About]"</span>)</div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;SendMessage.au3&gt;</span></span></div><div class="line"></div><div class="line"><span class="function">Func <span class="title">SendBang</span><span class="params">($szBang)</span></span></div><div class="line">   Local Const $hWnd = WinGetHandle("[CLASS:DummyRainWClass]")</div><div class="line">   If $hWnd &lt;&gt; <span class="number">0</span> Then</div><div class="line">      Local Const $iSize = StringLen($szBang) + <span class="number">1</span></div><div class="line"></div><div class="line">      Local Const $pMem = DllStructCreate(<span class="string">"wchar["</span> &amp; $iSize &amp; <span class="string">"]"</span>)</div><div class="line">      DllStructSetData($pMem, <span class="number">1</span>, $szBang)</div><div class="line"></div><div class="line">      Local Const $pCds = DllStructCreate(<span class="string">"dword;dword;ptr"</span>)</div><div class="line">      DllStructSetData($pCds, <span class="number">1</span>, <span class="number">1</span>)</div><div class="line">      DllStructSetData($pCds, <span class="number">2</span>, ($iSize * <span class="number">2</span>))</div><div class="line">      DllStructSetData($pCds, <span class="number">3</span>, DllStructGetPtr($pMem))</div><div class="line"></div><div class="line">      Local Const $WM_COPYDATA = <span class="number">0x004A</span></div><div class="line">      _SendMessage($hWnd, $WM_COPYDATA, <span class="number">0</span>, DllStructGetPtr($pCds))</div><div class="line">   EndIf</div><div class="line">EndFunc</div></pre></td></tr></table></figure>

</article>
</div>

			</div>
		</div>

		<div id="footer-push"></div>
	</div>

	<script src="/js/main.js?v=4"></script>
</body>
</html>
