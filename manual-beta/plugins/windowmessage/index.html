<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>WindowMessage plugin - Rainmeter 4.1 Beta Manual</title>
	<link href="/css/main.css?v=3" rel="stylesheet">
	<link rel="shortcut icon" href="//www.rainmeter.net/favicon.ico">
	<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6/html5shiv.min.js"></script><![endif]-->
</head>
<body>
	<div id="wrapper">
		<div id="top">
			<div class="container">
				<a id="logo" href="//rainmeter.net/"></a>
				<nav id="nav">
					<ul>
					<li><a href="//www.rainmeter.net">Home</a>
					<li><a href="/" class="active">Documentation</a>
					<li><a href="//www.rainmeter.net/discover">Discover</a>
					<li><a href="//forum.rainmeter.net">Community</a>
					</ul>
				</nav>
			</div>
		</div>

		<div class="container">
			<div class="row">
				<div id="side-content">
	<h1 id="category"><a href="/manual-beta">4.1 Beta Manual</a></h1>

	<form id="search-form" method="get" action="http://www.google.com/search">
		<input name="sitesearch" value="docs.rainmeter.net" type="hidden">
		<input id="search" name="q" maxlength="255" size="16" placeholder="Search" type="text">
	</form>

	<nav id="tree">
		<h1>Contents</h1>
<ul>
<li><a href="/manual-beta/getting-started/">Getting Started</a>
  <ul>
  <li><a href="/manual-beta/getting-started/setting-up/">Setting Up</a>
  <li><a href="/manual-beta/getting-started/using-rainmeter/">Using Rainmeter</a>
  <li><a href="/manual-beta/getting-started/customizing/">Customizing</a>
  <li><a href="/manual-beta/getting-started/creating-skins/">Creating Skins</a>
  <li><a href="/manual-beta/getting-started/skin-anatomy/">Anatomy of a Skin</a>
  <li><a href="/manual-beta/getting-started/basic-tutorials/">Basic Tutorials</a>
    <ul>
    <li><a href="/manual-beta/getting-started/basic-tutorials/launcher/">Launcher</a>
    <li><a href="/manual-beta/getting-started/basic-tutorials/clock/">Clock</a>
    <li><a href="/manual-beta/getting-started/basic-tutorials/system/">System</a>
    </ul>
  </ul>
<li><a href="/manual-beta/installing-rainmeter/">Installing Rainmeter</a>
<li><a href="/manual-beta/user-interface/">User Interface</a>
  <ul>
  <li><a href="/manual-beta/user-interface/manage/">Manage</a>
<ul>
  <li><a href="/manual-beta/user-interface/manage/new-skin">New Skin</a>
</ul>
  <li><a href="/manual-beta/user-interface/about/">About</a>
  <li><a href="/manual-beta/user-interface/context-menus/">Context Menus</a>
  </ul>
<li><a href="/manual-beta/installing-skins/">Installing Skins</a>
<li><a href="/manual-beta/arranging-skins/">Arranging Skins</a>
<li><a href="/manual-beta/publishing-skins/">Publishing Skins</a>
</ul>

<h1>Reference</h1>
<ul>
<li><a href="/manual-beta/settings/">Settings</a>
  <ul>
  <li><a href="/manual-beta/settings/rainmeter-section/">[Rainmeter] Section</a>
  <li><a href="/manual-beta/settings/traymeasure-section/">[TrayMeasure] Section</a>
  <li><a href="/manual-beta/settings/skin-sections/">[Skin] Sections</a>
  </ul>
<li><a href="/manual-beta/skins/">Skins</a>
  <ul>
  <li><a href="/manual-beta/skins/option-types/">Option Types</a>
  <li><a href="/manual-beta/skins/rainmeter-section/">[Rainmeter] Section</a>
  <li><a href="/manual-beta/skins/metadata-section/">[Metadata] Section</a>
  <li><a href="/manual-beta/skins/include-option/">@Include Options</a>
  <li><a href="/manual-beta/skins/resources-folder/">@Resources Folder</a>
  </ul>
<li><a href="/manual-beta/meters/">Meters</a>
  <ul>
  <li><a href="/manual-beta/meters/general-options/">General Options</a>
    <ul>
    <li><a href="/manual-beta/meters/general-options/image-options/">Image Options</a>
    <li><a href="/manual-beta/meters/general-options/meterstyles/">MeterStyles</a>
    <li><a href="/manual-beta/meters/general-options/tooltips/">Tooltips</a>
    </ul>
  <li><a href="/manual-beta/meters/bar/">Bar</a>
  <li><a href="/manual-beta/meters/bitmap/">Bitmap</a>
  <li><a href="/manual-beta/meters/button/">Button</a>
  <li><a href="/manual-beta/meters/histogram/">Histogram</a>
  <li><a href="/manual-beta/meters/image/">Image</a>
  <li><a href="/manual-beta/meters/line/">Line</a>
  <li><a href="/manual-beta/meters/rotator/">Rotator</a>
  <li><a href="/manual-beta/meters/roundline/">Roundline</a>
  <li><a href="/manual-beta/meters/shape/">Shape</a>
  <li><a href="/manual-beta/meters/string/">String</a>
<ul>
  <li><a href="/manual-beta/meters/string/inline/">Inline Options</a>
</ul>
  </ul>
<li><a href="/manual-beta/measures/">Measures</a>
  <ul>
  <li><a href="/manual-beta/measures/general-options/">General Options</a>
    <ul>
    <li><a href="/manual-beta/measures/general-options/ifactions/">IfActions</a>
    <li><a href="/manual-beta/measures/general-options/ifconditions/">IfConditions</a>
    <li><a href="/manual-beta/measures/general-options/ifmatchactions/">IfMatchActions</a>
    <li><a href="/manual-beta/measures/general-options/substitute/">Substitute</a>
    </ul>
  <li><a href="/manual-beta/measures/calc/">Calc</a>
  <li><a href="/manual-beta/measures/cpu/">CPU</a>
  <li><a href="/manual-beta/measures/freediskspace/">FreeDiskSpace</a>
  <li><a href="/manual-beta/measures/loop/">Loop</a>
  <li><a href="/manual-beta/measures/memory/">Memory</a>
  <li><a href="/manual-beta/measures/net/">Net</a>
  <li><a href="/manual-beta/measures/plugin/">Plugin</a>
  <li><a href="/manual-beta/measures/registry/">Registry</a>
  <li><a href="/manual-beta/measures/script/">Script</a>
  <li><a href="/manual-beta/measures/string/">String</a>
  <li><a href="/manual-beta/measures/time/">Time</a>
  <li><a href="/manual-beta/measures/uptime/">Uptime</a>
  </ul>
<li><a href="/manual-beta/plugins/">Plugins</a>
  <ul>
  <li><a href="/manual-beta/plugins/actiontimer/">ActionTimer</a>
  <li><a href="/manual-beta/plugins/advancedcpu/">AdvancedCPU</a>
  <li><a href="/manual-beta/plugins/audiolevel/">AudioLevel</a>
  <li><a href="/manual-beta/plugins/coretemp/">CoreTemp</a>
  <li><a href="/manual-beta/plugins/fileview/">FileView</a>
  <li><a href="/manual-beta/plugins/folderinfo/">FolderInfo</a>
  <li><a href="/manual-beta/plugins/inputtext/">InputText</a>
  <li><a href="/manual-beta/plugins/itunes/">iTunes</a>
  <li><a href="/manual-beta/plugins/mediakey/">MediaKey</a>
  <li><a href="/manual-beta/plugins/nowplaying/">NowPlaying</a>
  <li><a href="/manual-beta/plugins/perfmon/">PerfMon</a>
  <li><a href="/manual-beta/plugins/ping/">Ping</a>
  <li><a href="/manual-beta/plugins/power/">Power</a>
  <li><a href="/manual-beta/plugins/process/">Process</a>
  <li><a href="/manual-beta/plugins/quote/">Quote</a>
  <li><a href="/manual-beta/plugins/recyclemanager/">RecycleManager</a>
  <li><a href="/manual-beta/plugins/resmon/">ResMon</a>
  <li><a href="/manual-beta/plugins/runcommand/">RunCommand</a>
  <li><a href="/manual-beta/plugins/speedfan/">SpeedFan</a>
  <li><a href="/manual-beta/plugins/sysinfo/">SysInfo</a>
  <li><a href="/manual-beta/plugins/webparser/">WebParser</a>
  <li><a href="/manual-beta/plugins/wifistatus/">WiFiStatus</a>
  <li><a href="/manual-beta/plugins/win7audio/">Win7Audio</a>
  <li><a href="/manual-beta/plugins/windowmessage/">WindowMessage</a>
  </ul>
<li><a href="/manual-beta/bangs/">Bangs</a>
<li><a href="/manual-beta/formulas/">Formulas</a>
<li><a href="/manual-beta/variables/">Variables</a>
  <ul>
  <li><a href="/manual-beta/variables/nesting-variables/">Nesting Variables</a>
  <li><a href="/manual-beta/variables/built-in-variables/">Built-In Variables</a>
  <li><a href="/manual-beta/variables/section-variables/">Section Variables</a>
  <li><a href="/manual-beta/variables/character-variables/">Character Variables</a>
  <li><a href="/manual-beta/variables/mouse-variables/">Mouse Variables</a>
  </ul>
<li><a href="/manual-beta/groups/">Groups</a>
<li><a href="/manual-beta/mouse-actions/">Mouse Actions</a>
<li><a href="/manual-beta/lua-scripting/">Lua Scripting</a>
  <ul>
  <li><a href="/manual-beta/lua-scripting/inline-lua/">Inline Lua</a>
  </ul>
</ul>

<h1>More</h1>
<ul>
<li><a href="/manual/">4.0 Final Manual</a>
<li><a href="/tips/">Tips &amp; Tricks</a>
<li><a href="/snippets/">Snippets</a>
<li><a href="/developers/">Developers</a>
<li><a href="/history/">Version History</a>
</ul>

	</nav>
</div>
<div id="content">
	<header>
		<h1>WindowMessage plugin</h1>
	</header>
	<article><p><code>Plugin=WindowMessagePlugin</code> can be used to send and receive information from other applications. It can send window messages to other applications and show the result. For example, the plugin can be used to control WinAmp or some similar media players.</p>

<h2>Options</h2>
<dl>
	<dt>General measure options</dt>
	<dd>
		All <a href="/manual-beta/measures/general-options/">general measure options</a> are valid.
	</dd>

	<dt id="WindowName"><code>WindowName</code></dt>
	<dd>
		The name of the window. This is used to identify the window. It's not necessary to set this if the <code>WindowClass</code> is set.
	</dd>

	<dt id="WindowClass"><code>WindowClass</code></dt>
	<dd>
		The class of the window. This is used to identify the window. It's not necessary to set this if the <code>WindowName</code> is set.
	</dd>

	<dt id="WindowMessage"><code>WindowMessage</code></dt>
	<dd>
		This is the message to be send to the window. You need to define 3 parameters to where the first one is the <code>message</code> and the next ones are <code>wParam</code> and <code>lParam</code>. <b>Both wParam and lParam are unsigned decimal integers.</b> The measure returns the value returned by the SendMessage API function. If the <code>WindowMessage</code> is not given, the measure returns the window's current title.
	</dd>
</dl>

<h2>Bangs</h2>
<p>Messages can also be sent on demand with the <a href="/manual-beta/bangs/#CommandMeasure">!CommandMeasure</a> bang. The arguments are similar that of the <code>WindowMessage</code> option. <code>!CommandMeasure "MeasureName" "SendMessage Msg wParam lParam"</code></p>

<h2>Examples</h2>

<p>The following example returns the name of the song that is playing in WinAmp.</p>

<figure class="highlight ini"><table><tr><td class="code"><pre><div class="line"><span class="section">[MeasureWinamp]</span></div><div class="line"><span class="attr">Measure</span>=Plugin</div><div class="line"><span class="attr">Plugin</span>=WindowMessagePlugin</div><div class="line"><span class="attr">WindowClass</span>=Winamp v1.x</div><div class="line"><span class="attr">Substitute</span>=<span class="string">"[Paused]"</span>:<span class="string">""</span>,<span class="string">" - Winamp"</span>:<span class="string">""</span></div></pre></td></tr></table></figure>

<p>Check if Winamp is playing, or not. The following example returns <code>0</code> if it's not playing, <code>1</code> if it is playing, and <code>3</code> if it's paused.</p>

<figure class="highlight ini"><table><tr><td class="code"><pre><div class="line"><span class="section">[MeasureWinampPlaying]</span></div><div class="line"><span class="attr">Measure</span>=Plugin</div><div class="line"><span class="attr">Plugin</span>=WindowMessagePlugin</div><div class="line"><span class="attr">WindowClass</span>=Winamp v1.x</div><div class="line"><span class="attr">WindowMessage</span>=<span class="number">1024</span> <span class="number">0</span> <span class="number">104</span></div></pre></td></tr></table></figure>

<p>Show song progress. In the following example, the <code>[MeasureWinampDuration]</code> will return the current song position as a value between <code>0</code> and <code>1</code>. Then you can use the <a href="/manual-beta/meters/bar/">Bar</a> meter to display the value.</p>

<figure class="highlight ini"><table><tr><td class="code"><pre><div class="line"><span class="section">[MeasureWinampFull]</span></div><div class="line"><span class="attr">Measure</span>=Plugin</div><div class="line"><span class="attr">Plugin</span>=WindowMessagePlugin</div><div class="line"><span class="attr">WindowClass</span>=Winamp v1.x</div><div class="line"><span class="attr">WindowMessage</span>=<span class="number">1024</span> <span class="number">1</span> <span class="number">105</span></div><div class="line"></div><div class="line"><span class="section">[MeasureWinampCurr]</span></div><div class="line"><span class="attr">Measure</span>=Plugin</div><div class="line"><span class="attr">Plugin</span>=WindowMessagePlugin</div><div class="line"><span class="attr">WindowClass</span>=Winamp v1.x</div><div class="line"><span class="attr">WindowMessage</span>=<span class="number">1024</span> <span class="number">0</span> <span class="number">105</span></div><div class="line"></div><div class="line"><span class="section">[MeasureWinampDuration]</span></div><div class="line"><span class="attr">Measure</span>=Calc</div><div class="line"><span class="attr">Formula</span>=(MeasureWinampCurr&lt;=<span class="number">0</span>)?<span class="number">0</span>:(MeasureWinampCurr/(MeasureWinampFull*<span class="number">1000</span>+<span class="number">1</span>))</div></pre></td></tr></table></figure>

</article>
</div>

			</div>
		</div>

		<div id="footer-push"></div>
	</div>

	<script src="/js/main.js?v=5"></script>
</body>
</html>
